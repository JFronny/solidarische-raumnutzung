CREATE OR REPLACE FUNCTION DAY_OF_WEEK(timestamp) RETURNS int AS $$
BEGIN
    RETURN EXTRACT(DOW FROM $1);
END;
$$ LANGUAGE plpgsql;